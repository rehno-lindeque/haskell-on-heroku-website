<!doctype html>
<html class="no-transition" lang="en">
<head>
<meta charset="utf-8">
<title>Haskell on Heroku — Docs</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes,minimal-ui">
<base href="http://haskellonheroku.com/">
<link rel="canonical" href="http://haskellonheroku.com/docs/">
<link rel="icon" type="image/png" href="_images/favicon-48.png" sizes="48x48">
<link rel="icon" type="image/png" href="_images/favicon-16.png" sizes="16x16">
<link rel="icon" type="image/png" href="_images/favicon-32.png" sizes="32x32">
<link rel="stylesheet" href="_stylesheets.css.gz">


</head>
<body>
<header id="top">
<div class="wrapper">
<nav id="header-menu-bar" class="menu-bar">
<h1 class="logotype"><a href="." title="Haskell on Heroku">Haskell on Heroku</a></h1>
<span id="header-button" class="menu-button"><a href="" title="Menu">Menu</a></span>
<ul id="header-menu" class="menu">
<li><a href="about/">About</a></li> <li><a href="docs/">Docs</a></li> <li><a href="support/">Support</a></li> <li><a href="https://github.com/mietek/haskell-on-heroku/">GitHub</a></li>
</ul>
<script>
if (localStorage['header-menu-open']) {
  document.getElementById('header-menu-bar').classList.add('open');
  document.getElementById('header-menu').classList.add('open');
  document.getElementById('header-button').classList.add('open');
}
</script>
</nav>


</div>
</header>

<main id="more">
<div class="wrapper">
<section id="docs" class="level1">
<h1>Docs</h1>
<p>Work in progress.</p>
<ul>
<li><a href="docs/reference/">Reference</a></li>
</ul>
<section id="on-buckets" class="level2">
<h2>On buckets</h2>
<p>Haskell on Heroku is intended to be used with a private Amazon S3 bucket, defined by the <a href="docs/reference/#haskell_s3_bucket"><code>HASKELL_S3_BUCKET</code></a> configuration variable.</p>
<p>Packages prebuilt on a Heroku one-off dyno need to be available during app compilation, which is performed on an unspecified compile dyno. Compile dynos have exclusive access to the Heroku compile cache. As it is not possible to write to the compile cache from an one-dyno, some form of external storage must be used to help transfer the packages, which is where the bucket comes in.</p>
<p>Additionally, sharing the same bucket between multiple apps helps save work by allowing common packages to be reused.</p>
<p>There are three modes of operation:</p>
<ol type="1">
<li><p>If the bucket is not available, Haskell on Heroku will be unable to prebuild packages, and will only use <a href="http://halcyon.sh/docs/public-prebuilt-packages/">public prebuilt packages</a>. As these packages cannot contain all dependencies required to compile every app, only some apps will deploy successfully in this mode.</p></li>
<li><p>Similarly, if the bucket is available, but uploading to it is not allowed—either by an S3 policy, or by setting <a href="docs/reference/#haskell_no_upload"><code>HASKELL_NO_UPLOAD</code></a> to <code>1</code>—Haskell on Heroku will only use the packages which already exist in the bucket.</p></li>
<li><p>Finally, if the bucket is available, and uploading to it is allowed, Haskell on Heroku will archive any prebuilt packages in the bucket for later reuse. This is the optimal mode.</p></li>
</ol>
<p>Access to the bucket is controlled by setting the <a href="docs/reference/#haskell_aws_access_key"><code>HASKELL_AWS_ACCESS_KEY_ID</code></a> and <a href="docs/reference/#haskell_aws_secret_access_key"><code>HASKELL_AWS_SECRET_ACCESS_KEY</code></a> configuration variables.</p>
</section>
</section>
</div>
</main>
<footer id="bottom">
<div class="wrapper">
<nav id="footer-menu-bar" class="menu-bar">
<h1 class="logotype"><a href="." title="Haskell on Heroku">Haskell on Heroku</a></h1>
<span id="footer-button"><a href="#top" title="Top">Top</a></span>
<ul id="footer-menu" class="menu open">
<li><a href="about/">About</a></li> <li><a href="docs/">Docs</a></li> <li><a href="support/">Support</a></li> <li><a href="https://github.com/mietek/haskell-on-heroku/">GitHub</a></li>
</ul>
</nav>
<aside> <p> Made by <a href="http://mietek.io/">Miëtek Bak</a>. Supported by <a href="http://leastfixed.com/">Least Fixed</a>. Published under the <a href="license/">MIT X11 License</a>. Not affiliated with <a href="http://heroku.com/">Heroku</a>. </p> </aside>

</div>
</footer>
<!--[if lte IE 9]>
<div id="what-browser">
<div class="wrapper">
<aside>
<p>Please update your browser. “<a href="http://whatbrowser.org/" title="Find out!">What browser?</a>”</p>
</aside>
</div>
</div>
<![endif]-->
<script async src="_scripts.js.gz"></script>
</body>
</html>
